{% extends "base.html" %}

{% block title %}Editar Usuário{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center">
    <h1>Editar Usuário</h1>
    <a href="{{ url_for('users_page') }}" class="btn btn-outline-secondary">Voltar para a Lista</a>
</div>
<p>Modifique as informações do usuário <strong>{{ user.email }}</strong> (ID: {{ user.id }}).</p>

<hr>

<form method="POST">
    <div class="card">
        <div class="card-body">
            <h5 class="card-title">Detalhes da Assinatura</h5>

            <div class="mb-3">
                <label for="plan" class="form-label">Plano</label>
                <select class="form-select" id="plan" name="plan">
                    <option value="free" {% if user.plan == 'free' %}selected{% endif %}>Free</option>
                    <option value="vip" {% if user.plan == 'vip' %}selected{% endif %}>VIP</option>
                </select>
            </div>

            <div class="mb-3">
                <label for="validity_days" class="form-label">Dias de Validade do VIP</label>
                <input type="number" class="form-control" id="validity_days" name="validity_days" value="{{ user.plan_validity_days or 30 }}">
                <div class="form-text">
                    Define quantos dias de VIP o usuário terá a partir de hoje. Se o plano for alterado para 'Free', este valor será ignorado.
                </div>
            </div>

            <button type="submit" class="btn btn-primary">Salvar Alterações</button>
        </div>
    </div>
</form>

<script>
    // Script opcional para mostrar/ocultar o campo de dias
    const planSelect = document.getElementById('plan');
    const validityField = document.getElementById('validity_days').parentElement;

    function toggleValidityField() {
        if (planSelect.value === 'free') {
            validityField.style.display = 'none';
        } else {
            validityField.style.display = 'block';
        }
    }

    // Executa na carga da página e quando o select muda
    toggleValidityField();
    planSelect.addEventListener('change', toggleValidityField);
</script>
{% endblock %}
